/*
* Async Google Maps API loading
*/
L.DeferredLayer=L.LayerGroup.extend({options:{js:[],init:null},_script_cache:{},initialize:function(a){L.Util.setOptions(this,a),L.LayerGroup.prototype.initialize.apply(this),this._loaded=!1},onAdd:function(a){if(L.LayerGroup.prototype.onAdd.apply(this,[a]),!this._loaded){var b=function(){this._loaded=!0;var a=this.options.init();a&&this.addLayer(a)};this._loadScripts(this.options.js.reverse(),L.Util.bind(b,this))}},_loadScripts:function(a,b,c){function h(){d._loadScripts(a,b,c)}if(!a||0===a.length)return b(c);var f,d=this,e=a.pop();if(f=this._script_cache[e],void 0===f){f={url:e,wait:[]};var g=document.createElement("script");g.src=e,g.type="text/javascript",g.onload=function(){f.e.readyState="completed";var a=0;for(a=0;a<f.wait.length;a++)f.wait[a]()},f.e=g,document.getElementsByTagName("head")[0].appendChild(g)}f.wait.push(h),"completed"===f.e.readyState&&h(),this._script_cache[e]=f}});
/*
 * Google Maps plugin - http://psha.org.ru/b/leaflet-plugins.html
*/
"enabled"==mapsmarkerjspro.google_maps_api_status&&(("disabled"==mapsmarkerjspro.google_deferred_loading||"backend"==mapsmarkerjspro.google_script_loading)&&google.load("maps","3",{other_params:mapsmarkerjspro.googlemaps_language+mapsmarkerjspro.googlemaps_base_domain+mapsmarkerjspro.googlemaps_libraries+"&key="+mapsmarkerjspro.google_maps_api_key}),L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:mapsmarkerjspro.maxzoom,maxNativeZoom:21,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,mapOptions:{backgroundColor:"#F6F6F6"}},initialize:function(a,b){L.Util.setOptions(this,b),this._ready=void 0!==google.maps.Map,this._ready||L.Google.asyncWait.push(this),this._type=a||"SATELLITE"},onAdd:function(a,b){this._map=a,this._insertAtTheBottom=b,this._initContainer(),this._initMapObject(),a.on("viewreset",this._reset,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,0,this),a.on("move drag",this._update,this),a.on("zoomanim",this._handleZoomAnim,this),a._controlCorners.bottomright.style.marginBottom="15px",a._controlCorners.bottomleft.style.marginBottom="21px",this._reset(),this._update(),L.polyline([[0,0]]).addTo(this._map)},onRemove:function(a){a._container.removeChild(this._container),a.off("viewreset",this._reset,this),a.off("move drag",this._update,this),a.off("zoomanim",this._handleZoomAnim,this),a._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(a){this.options.opacity=a,1>a&&L.DomUtil.setOpacity(this._container,a)},setElementSize:function(a,b){a.style.width=b.x+"px",a.style.height=b.y+"px"},_initContainer:function(){var a=this._map._container,b=a.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),a.insertBefore(this._container,b),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=new google.maps.LatLng(0,0);var map=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,backgroundColor:this.options.mapOptions.backgroundColor});if("disabled"!=mapsmarkerjspro.google_styling_json){var styles=eval(mapsmarkerjspro.google_styling_json);map.setOptions({styles:styles})}var _this=this;this._reposition=google.maps.event.addListenerOnce(map,"center_changed",function(){_this.onReposition()}),this._google=map,google.maps.event.addListenerOnce(map,"idle",function(){_this._checkZoomLevels()}),google.maps.event.addListenerOnce(map,"tilesloaded",function(){_this.fire("load")}),this.fire("MapObjectInitialized",{mapObject:map})}},_checkZoomLevels:function(){void 0!==this._map.getZoom()&&this._google.getZoom()!==this._map.getZoom()&&this._map.setZoom(this._google.getZoom())},_reset:function(){this._initContainer()},_update:function(){if(this._google){this._resize();var a=this._map.getCenter(),b=new google.maps.LatLng(a.lat,a.lng);this._google.setCenter(b),void 0!==this._map.getZoom()&&this._google.setZoom(Math.round(this._map.getZoom())),this._checkZoomLevels()}},_resize:function(){var a=this._map.getSize();(this._container.style.width!==a.x||this._container.style.height!==a.y)&&(this.setElementSize(this._container,a),this.onReposition())},_handleZoomAnim:function(a){var b=a.center,c=new google.maps.LatLng(b.lat,b.lng);this._google.setCenter(c),this._google.setZoom(Math.round(a.zoom))},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[],L.Google.asyncInitialize=function(){var a;for(a=0;a<L.Google.asyncWait.length;a++){var b=L.Google.asyncWait[a];b._ready=!0,b._container&&(b._initMapObject(),b._update())}L.Google.asyncWait=[]});
/*
 * bing maps plugins - http://psha.org.ru/b/leaflet-plugins.html
*/
L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:this.type,attribution:'<a href="https://www.bing.com/maps/" target="_blank">Bing Maps</a>',culture:mapsmarkerjspro.bing_culture},initialize:function(a,b){L.Util.setOptions(this,b),this._key=a,this._url=null,this._providers=[],this.metaRequested=!1},tile2quad:function(a,b,c){for(var d="",e=c;e>0;e--){var f=0,g=1<<e-1;0!==(a&g)&&(f+=1),0!==(b&g)&&(f+=2),d+=f}return d},getTileUrl:function(a){var b=this._getZoomForUrl(),c=this.options.subdomains,d=this.options.subdomains[Math.abs((a.x+a.y)%c.length)];return this._url.replace("{subdomain}",d).replace("{quadkey}",this.tile2quad(a.x,a.y,b)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(!this.metaRequested){this.metaRequested=!0;var a=this,b="_bing_metadata_"+L.Util.stamp(this);window[b]=function(c){window[b]=void 0;var d=document.getElementById(b);if(d.parentNode.removeChild(d),c.errorDetails)throw new Error(c.errorDetails);a.initMetadata(c)};var c="file:"===document.location.protocol?"http":document.location.protocol.slice(0,-1),d=c+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+b+"&key="+this._key+"&UriScheme="+c,e=document.createElement("script");e.type="text/javascript",e.src=d,e.id=b,document.getElementsByTagName("head")[0].appendChild(e)}},initMetadata:function(a){var b=a.resourceSets[0].resources[0];if(this.options.subdomains=b.imageUrlSubdomains,this._url=b.imageUrl,b.imageryProviders)for(var c=0;c<b.imageryProviders.length;c++)for(var d=b.imageryProviders[c],e=0;e<d.coverageAreas.length;e++){var f=d.coverageAreas[e],g={zoomMin:f.zoomMin,zoomMax:f.zoomMax,active:!1},h=new L.LatLngBounds(new L.LatLng(f.bbox[0]+.01,f.bbox[1]+.01),new L.LatLng(f.bbox[2]-.01,f.bbox[3]-.01));g.bounds=h,g.attrib=d.attribution,this._providers.push(g)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var a=this._map.getBounds(),b=this._map.getZoom(),c=0;c<this._providers.length;c++){var d=this._providers[c];b<=d.zoomMax&&b>=d.zoomMin&&a.intersects(d.bounds)?(d.active||this._map.attributionControl&&this._map.attributionControl.addAttribution(d.attrib),d.active=!0):(d.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(d.attrib),d.active=!1)}},onAdd:function(a){this.loadMetadata(),L.TileLayer.prototype.onAdd.apply(this,[a])},onRemove:function(a){for(var b=0;b<this._providers.length;b++){var c=this._providers[b];c.active&&(this._map.attributionControl&&this._map.attributionControl.removeAttribution(c.attrib),c.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[a])}}),L.bingLayer=function(a,b){return new L.BingLayer(a,b)};
/*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster (v0.4.0-hotfix1, 27/03/15)
 (c) 2012-2015, Dave Leaver, smartrak
*/
!function(t,e,i){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222"},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[]},addLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.addLayers(e)}if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this;if(!this._map)return this._needsClustering.push(t),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom);var n=t,s=this._map.getZoom();if(t.__parent)for(;n.__parent._zoom>=s;)n=n.__parent;return this._currentShownBounds.contains(n.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,n):this._animationAddLayerNonAnimated(t,n)),this},removeLayer:function(t){if(t instanceof L.LayerGroup){var e=[];for(var i in t._layers)e.push(t._layers[i]);return this.removeLayers(e)}return t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push(t),this):(this._nonPointGroup.removeLayer(t),this)},addLayers:function(t){var e,i,n,s,r=this._featureGroup,o=this._nonPointGroup,a=this.options.chunkedLoading,h=this.options.chunkInterval,u=this.options.chunkProgress;if(this._map){var _=0,l=(new Date).getTime(),d=L.bind(function(){for(var e=(new Date).getTime();_<t.length;_++){if(a&&0===_%200){var i=(new Date).getTime()-e;if(i>h)break}if(s=t[_],s.getLatLng){if(!this.hasLayer(s)&&(this._addLayer(s,this._maxZoom),s.__parent&&2===s.__parent.getChildCount())){var n=s.__parent.getAllChildMarkers(),p=n[0]===s?n[1]:n[0];r.removeLayer(p)}}else o.addLayer(s)}u&&u(_,t.length,(new Date).getTime()-l),_===t.length?(this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(d,this.options.chunkDelay)},this);d()}else{for(e=[],i=0,n=t.length;n>i;i++)s=t[i],s.getLatLng?this.hasLayer(s)||e.push(s):o.addLayer(s);this._needsClustering=this._needsClustering.concat(e)}return this},removeLayers:function(t){var e,i,n,s=this._featureGroup,r=this._nonPointGroup;if(this._unspiderfy&&this._unspiderfy(),!this._map){for(e=0,i=t.length;i>e;e++)n=t[e],this._arraySplice(this._needsClustering,n),r.removeLayer(n);return this}for(e=0,i=t.length;i>e;e++)n=t[e],n.__parent?(this._removeLayer(n,!0,!0),s.hasLayer(n)&&(s.removeLayer(n),n.clusterShow&&n.clusterShow())):r.removeLayer(n);return this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),s.eachLayer(function(t){t instanceof L.MarkerCluster&&t._updateIcon()}),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){delete t.__parent}),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var i,n=this._needsClustering.slice();for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(n),i=n.length-1;i>=0;i--)t.call(e,n[i]);this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return this.eachLayer(function(i){L.stamp(i)===t&&(e=i)}),e},hasLayer:function(t){if(!t)return!1;var e,i=this._needsClustering;for(e=i.length-1;e>=0;e--)if(i[e]===t)return!0;for(i=this._needsRemoving,e=i.length-1;e>=0;e--)if(i[e]===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var i=function(){if((t._icon||t.__parent._icon)&&!this._inZoomAnimation)if(this._map.off("moveend",i,this),this.off("animationend",i,this),t._icon)e();else if(t.__parent._icon){var n=function(){this.off("spiderfied",n,this),e()};this.on("spiderfied",n,this),t.__parent.spiderfy()}};if(t._icon&&this._map.getBounds().contains(t.getLatLng()))e();else if(t.__parent._zoom<this._map.getZoom())this._map.on("moveend",i,this),this._map.panTo(t.getLatLng());else{var n=function(){this._map.off("movestart",n,this),n=null};this._map.on("movestart",n,this),this._map.on("moveend",i,this),this.on("animationend",i,this),t.__parent.zoomToBounds(),n&&i.call(this)}},onAdd:function(t){this._map=t;var e,i,n;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.onAdd(t),this._nonPointGroup.onAdd(t),this._gridClusters||this._generateInitialClusters(),e=0,i=this._needsRemoving.length;i>e;e++)n=this._needsRemoving[e],this._removeLayer(n,!0);this._needsRemoving=[],this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),i=this._needsClustering,this._needsClustering=[],this.addLayers(i)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),this._hideCoverage(),this._featureGroup.onRemove(t),this._nonPointGroup.onRemove(t),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var i=t.length-1;i>=0;i--)if(t[i]===e)return t.splice(i,1),!0},_removeLayer:function(t,e,i){var n=this._gridClusters,s=this._gridUnclustered,r=this._featureGroup,o=this._map;if(e)for(var a=this._maxZoom;a>=0&&s[a].removeObject(t,o.project(t.getLatLng(),a));a--);var h,u=t.__parent,_=u._markers;for(this._arraySplice(_,t);u&&(u._childCount--,!(u._zoom<0));)e&&u._childCount<=1?(h=u._markers[0]===t?u._markers[1]:u._markers[0],n[u._zoom].removeObject(u,o.project(u._cLatLng,u._zoom)),s[u._zoom].addObject(h,o.project(h.getLatLng(),u._zoom)),this._arraySplice(u.__parent._childClusters,u),u.__parent._markers.push(h),h.__parent=u.__parent,u._icon&&(r.removeLayer(u),i||r.addLayer(h))):(u._recalculateBounds(),i&&u._icon||u._updateIcon()),u=u.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},_propagateEvent:function(t){if(t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;t.type="cluster"+t.type}this.fire(t.type,t)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return i+=10>e?"small":100>e?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(e||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=this._map;t.layer._bounds._northEast.equals(t.layer._bounds._southWest)?this.options.spiderfyOnMaxZoom&&t.layer.spiderfy():e.getMaxZoom()===e.getZoom()?this.options.spiderfyOnMaxZoom&&t.layer.spiderfy():this.options.zoomToBoundsOnClick&&t.layer.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&e._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(t||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=this._map._zoom,this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._map._zoom,t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=this._map.getMaxZoom(),e=this.options.maxClusterRadius,i=e;"function"!=typeof e&&(i=function(){return e}),this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var n=t;n>=0;n--)this._gridClusters[n]=new L.DistanceGrid(i(n)),this._gridUnclustered[n]=new L.DistanceGrid(i(n));this._topClusterLevel=new L.MarkerCluster(this,-1)},_addLayer:function(t,e){var i,n,s=this._gridClusters,r=this._gridUnclustered;for(this.options.singleMarkerMode&&(t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}}));e>=0;e--){i=this._map.project(t.getLatLng(),e);var o=s[e].getNearObject(i);if(o)return o._addChild(t),t.__parent=o,void 0;if(o=r[e].getNearObject(i)){var a=o.__parent;a&&this._removeLayer(o,!1);var h=new L.MarkerCluster(this,e,o,t);s[e].addObject(h,this._map.project(h._cLatLng,e)),o.__parent=h,t.__parent=h;var u=h;for(n=e-1;n>a._zoom;n--)u=new L.MarkerCluster(this,n,u),s[n].addObject(u,this._map.project(o.getLatLng(),n));for(a._addChild(u),n=e;n>=0&&r[n].removeObject(o,this._map.project(o.getLatLng(),n));n--);return}r[e].addObject(t,i)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){this._processQueue(),this._zoom<this._map._zoom&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,this._map._zoom)):this._zoom>this._map._zoom?(this._animationStart(),this._animationZoomOut(this._zoom,this._map._zoom)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this._map.getBounds();var t=this._map,e=t.getBounds(),i=e._southWest,n=e._northEast,s=L.Browser.mobile?0:Math.abs(i.lat-n.lat),r=L.Browser.mobile?0:Math.abs(i.lng-n.lng);return new L.LatLngBounds(new L.LatLng(i.lat-s,i.lng-r,!0),new L.LatLng(n.lat+s,n.lng+r,!0))},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var i=e.getAllChildMarkers();this._featureGroup.removeLayer(i[0]),this._featureGroup.removeLayer(i[1])}else e._updateIcon()}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(t,e){var i,n=this._getExpandedVisibleBounds(),s=this._featureGroup;this._topClusterLevel._recursively(n,t,0,function(r){var o,a=r._latlng,h=r._markers;for(n.contains(a)||(a=null),r._isSingleParent()&&t+1===e?(s.removeLayer(r),r._recursivelyAddChildrenToMap(null,e,n)):(r.clusterHide(),r._recursivelyAddChildrenToMap(a,e,n)),i=h.length-1;i>=0;i--)o=h[i],n.contains(o._latlng)||s.removeLayer(o)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(n,e),s.eachLayer(function(t){t instanceof L.MarkerCluster||!t._icon||t.clusterShow()}),this._topClusterLevel._recursively(n,t,e,function(t){t._recursivelyRestoreChildPositions(e)}),this._enqueue(function(){this._topClusterLevel._recursively(n,t,0,function(t){s.removeLayer(t),t.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(t,e,i){var n=this._getExpandedVisibleBounds();t._recursivelyAnimateChildrenInAndAddSelfToMap(n,e+1,i);var s=this;this._forceLayout(),t._recursivelyBecomeVisible(n,i),this._enqueue(function(){if(1===t._childCount){var r=t._markers[0];r.setLatLng(r.getLatLng()),r.clusterShow&&r.clusterShow()}else t._recursively(n,i,0,function(t){t._recursivelyRemoveChildrenFromMap(n,e+1)});s._animationEnd()})},_animationAddLayer:function(t,e){var i=this,n=this._featureGroup;n.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue(function(){n.removeLayer(t),t.clusterShow(),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(e.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)},L.MarkerCluster=L.Marker.extend({initialize:function(t,e,i,n){L.Marker.prototype.initialize.call(this,i?i._cLatLng||i.getLatLng():new L.LatLng(0,0),{icon:this}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._bounds=new L.LatLngBounds,i&&this._addChild(i),n&&this._addChild(n)},getAllChildMarkers:function(t){t=t||[];for(var e=this._childClusters.length-1;e>=0;e--)this._childClusters[e].getAllChildMarkers(t);for(var i=this._markers.length-1;i>=0;i--)t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(){for(var t,e=this._childClusters.slice(),i=this._group._map,n=i.getBoundsZoom(this._bounds),s=this._zoom+1,r=i.getZoom();e.length>0&&n>s;){s++;var o=[];for(t=0;t<e.length;t++)o=o.concat(e[t]._childClusters);e=o}n>s?this._group._map.setView(this._latlng,s):r>=n?this._group._map.setView(this._latlng,r+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._expandBounds(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_expandBounds:function(t){var e,i=t._wLatLng||t._latlng;t instanceof L.MarkerCluster?(this._bounds.extend(t._bounds),e=t._childCount):(this._bounds.extend(i),e=1),this._cLatLng||(this._cLatLng=t._cLatLng||i);var n=this._childCount+e;this._wLatLng?(this._wLatLng.lat=(i.lat*e+this._wLatLng.lat*this._childCount)/n,this._wLatLng.lng=(i.lng*e+this._wLatLng.lng*this._childCount)/n):this._latlng=this._wLatLng=new L.LatLng(i.lat,i.lng)},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,i){this._recursively(t,0,i-1,function(t){var i,n,s=t._markers;for(i=s.length-1;i>=0;i--)n=s[i],n._icon&&(n._setPos(e),n.clusterHide())},function(t){var i,n,s=t._childClusters;for(i=s.length-1;i>=0;i--)n=s[i],n._icon&&(n._setPos(e),n.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,i){this._recursively(t,i,0,function(n){n._recursivelyAnimateChildrenIn(t,n._group._map.latLngToLayerPoint(n.getLatLng()).round(),e),n._isSingleParent()&&e-1===i?(n.clusterShow(),n._recursivelyRemoveChildrenFromMap(t,e)):n.clusterHide(),n._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,0,e,null,function(t){t.clusterShow()})},_recursivelyAddChildrenToMap:function(t,e,i){this._recursively(i,-1,e,function(n){if(e!==n._zoom)for(var s=n._markers.length-1;s>=0;s--){var r=n._markers[s];i.contains(r._latlng)&&(t&&(r._backupLatlng=r.getLatLng(),r.setLatLng(t),r.clusterHide&&r.clusterHide()),n._group._featureGroup.addLayer(r))}},function(e){e._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._restorePosition();else for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i){var n,s;this._recursively(t,-1,e-1,function(t){for(s=t._markers.length-1;s>=0;s--)n=t._markers[s],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.clusterShow&&n.clusterShow())},function(t){for(s=t._childClusters.length-1;s>=0;s--)n=t._childClusters[s],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.clusterShow&&n.clusterShow())})},_recursively:function(t,e,i,n,s){var r,o,a=this._childClusters,h=this._zoom;if(e>h)for(r=a.length-1;r>=0;r--)o=a[r],t.intersects(o._bounds)&&o._recursively(t,e,i,n,s);else if(n&&n(this),s&&this._zoom===i&&s(this),i>h)for(r=a.length-1;r>=0;r--)o=a[r],t.intersects(o._bounds)&&o._recursively(t,e,i,n,s)},_recalculateBounds:function(){var t,e=this._markers,i=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,t=e.length-1;t>=0;t--)this._expandBounds(e[t]);for(t=i.length-1;t>=0;t--)this._expandBounds(i[t])},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.Marker.include({clusterHide:function(){return this.options.opacityWhenUnclustered=this.options.opacity||1,this.setOpacity(0)},clusterShow:function(){var t=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);return delete this.options.opacityWhenUnclustered,t}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var i=this._getCoord(e.x),n=this._getCoord(e.y),s=this._grid,r=s[n]=s[n]||{},o=r[i]=r[i]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,o.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var i,n,s=this._getCoord(e.x),r=this._getCoord(e.y),o=this._grid,a=o[r]=o[r]||{},h=a[s]=a[s]||[];for(delete this._objectPoint[L.Util.stamp(t)],i=0,n=h.length;n>i;i++)if(h[i]===t)return h.splice(i,1),1===n&&delete a[s],!0},eachObject:function(t,e){var i,n,s,r,o,a,h,u=this._grid;for(i in u){o=u[i];for(n in o)for(a=o[n],s=0,r=a.length;r>s;s++)h=t.call(e,a[s]),h&&(s--,r--)}},getNearObject:function(t){var e,i,n,s,r,o,a,h,u=this._getCoord(t.x),_=this._getCoord(t.y),l=this._objectPoint,d=this._sqCellSize,p=null;for(e=_-1;_+1>=e;e++)if(s=this._grid[e])for(i=u-1;u+1>=i;i++)if(r=s[i])for(n=0,o=r.length;o>n;n++)a=r[n],h=this._sqDist(l[L.Util.stamp(a)],t),d>h&&(d=h,p=a);return p},_getCoord:function(t){return Math.floor(t/this._cellSize)},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n}},function(){L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat,n=e[0].lng-e[1].lng;return n*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i,n,s,r=0,o=null,a=[];for(i=e.length-1;i>=0;i--)n=e[i],s=this.getDistant(n,t),s>0&&(a.push(n),s>r&&(r=s,o=n));return{maxPoint:o,newPoints:a}},buildConvexHull:function(t,e){var i=[],n=this.findMostDistantPointFromBaseLine(t,e);return n.maxPoint?(i=i.concat(this.buildConvexHull([t[0],n.maxPoint],n.newPoints)),i=i.concat(this.buildConvexHull([n.maxPoint,t[1]],n.newPoints))):[t[0]]},getConvexHull:function(t){var e,i=!1,n=!1,s=null,r=null;for(e=t.length-1;e>=0;e--){var o=t[e];(i===!1||o.lat>i)&&(s=o,i=o.lat),(n===!1||o.lat<n)&&(r=o,n=o.lat)}var a=[].concat(this.buildConvexHull([r,s],t),this.buildConvexHull([s,r],t));return a}}}(),L.MarkerCluster.include({getConvexHull:function(){var t,e,i=this.getAllChildMarkers(),n=[];for(e=i.length-1;e>=0;e--)t=i[e].getLatLng(),n.push(t);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(),i=this._group,n=i._map,s=n.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,s):(s.y+=10,t=this._generatePointsCircle(e.length,s)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i,n,s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),r=s/this._2PI,o=this._2PI/t,a=[];for(a.length=t,i=t-1;i>=0;i--)n=this._circleStartAngle+i*o,a[i]=new L.Point(e.x+r*Math.cos(n),e.y+r*Math.sin(n))._round();return a},_generatePointsSpiral:function(t,e){var i,n=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,s=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,r=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,o=0,a=[];for(a.length=t,i=t-1;i>=0;i--)o+=s/n+5e-4*i,a[i]=new L.Point(e.x+n*Math.cos(o),e.y+n*Math.sin(o))._round(),n+=this._2PI*r/o;return a},_noanimationUnspiderfy:function(){var t,e,i=this._group,n=i._map,s=i._featureGroup,r=this.getAllChildMarkers();for(this.setOpacity(1),e=r.length-1;e>=0;e--)t=r[e],s.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(n.removeLayer(t._spiderLeg),delete t._spiderLeg);i._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:function(){return e.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate")>-1}(),_animationSpiderfy:function(t,n){var s,r,o,a,h=this,u=this._group,_=u._map,l=u._featureGroup,d=_.latLngToLayerPoint(this._latlng);for(s=t.length-1;s>=0;s--)r=t[s],r.setOpacity?(r.setZIndexOffset(1e6),r.clusterHide(),l.addLayer(r),r._setPos(d)):l.addLayer(r);u._forceLayout(),u._animationStart();var p=L.Path.SVG?0:.3,c=L.Path.SVG_NS;for(s=t.length-1;s>=0;s--){a=_.layerPointToLatLng(n[s]),r=t[s],r._preSpiderfyLatlng=r._latlng,r.setLatLng(a),r.setOpacity&&r.clusterShow();var f=this._group.options.spiderLegPolylineOptions;if(f.opacity===i&&(f.opacity=p),o=new L.Polyline([h._latlng,a],f),_.addLayer(o),r._spiderLeg=o,L.Path.SVG&&this.SVG_ANIMATION){var m=o._path.getTotalLength();o._path.setAttribute("stroke-dasharray",m+","+m);var g=e.createElementNS(c,"animate");g.setAttribute("attributeName","stroke-dashoffset"),g.setAttribute("begin","indefinite"),g.setAttribute("from",m),g.setAttribute("to",0),g.setAttribute("dur",.25),o._path.appendChild(g),g.beginElement(),g=e.createElementNS(c,"animate"),g.setAttribute("attributeName","stroke-opacity"),g.setAttribute("attributeName","stroke-opacity"),g.setAttribute("begin","indefinite"),g.setAttribute("from",0),g.setAttribute("to",.5),g.setAttribute("dur",.25),o._path.appendChild(g),g.beginElement()}}if(h.setOpacity(.3),L.Path.SVG)for(this._group._forceLayout(),s=t.length-1;s>=0;s--)r=t[s]._spiderLeg,r.options.opacity=.5,r._path.setAttribute("stroke-opacity",.5);setTimeout(function(){u._animationEnd(),u.fire("spiderfied")},200)},_animationUnspiderfy:function(t){var e,i,n,s=this._group,r=s._map,o=s._featureGroup,a=t?r._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):r.latLngToLayerPoint(this._latlng),h=this.getAllChildMarkers(),u=L.Path.SVG&&this.SVG_ANIMATION;for(s._animationStart(),this.setOpacity(1),i=h.length-1;i>=0;i--)e=h[i],e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,e.setOpacity?(e._setPos(a),e.clusterHide()):o.removeLayer(e),u&&(n=e._spiderLeg._path.childNodes[0],n.setAttribute("to",n.getAttribute("from")),n.setAttribute("from",0),n.beginElement(),n=e._spiderLeg._path.childNodes[1],n.setAttribute("from",.5),n.setAttribute("to",0),n.setAttribute("stroke-opacity",0),n.beginElement(),e._spiderLeg._path.setAttribute("stroke-opacity",0)));setTimeout(function(){var t=0;for(i=h.length-1;i>=0;i--)e=h[i],e._spiderLeg&&t++;for(i=h.length-1;i>=0;i--)e=h[i],e._spiderLeg&&(e.setOpacity&&(e.clusterShow(),e.setZIndexOffset(0)),t>1&&o.removeLayer(e),r.removeLayer(e._spiderLeg),delete e._spiderLeg);s._animationEnd()},200)}}:{_animationSpiderfy:function(t,e){var i,n,s,r,o=this._group,a=o._map,h=o._featureGroup;for(i=t.length-1;i>=0;i--){r=a.layerPointToLatLng(e[i]),n=t[i],n._preSpiderfyLatlng=n._latlng,n.setLatLng(r),n.setZIndexOffset&&n.setZIndexOffset(1e6),h.addLayer(n);var u=this._group.options.spiderLegPolylineOptions;s=new L.Polyline([this._latlng,r],u),a.addLayer(s),n._spiderLeg=s}this.setOpacity(.3),o.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Path.SVG&&!L.Browser.touch&&this._map._initPathRoot()},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.setOpacity(1),t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}})}(window,document);
/*
* MiniMap plugin by Norkart, Copyright (c) 2016, Norkart AS, All rights reserved.
* License details: https://github.com/Norkart/Leaflet-MiniMap/blob/master/LICENSE.txt
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&(module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.Control.MiniMap=a(L),b.L.control.minimap=function(a,c){return new b.L.Control.MiniMap(a,c)})}(function(a){var b=a.Control.extend({options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,centerFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,minimized:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:mapsmarkerjspro.minimap_hide,showText:mapsmarkerjspro.minimap_show},mapOptions:{}},initialize:function(b,c){a.Util.setOptions(this,c),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=b},onAdd:function(b){this._mainMap=b,this._container=a.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",a.DomEvent.disableClickPropagation(this._container),a.DomEvent.on(this._container,"mousewheel",a.DomEvent.stopPropagation);var c={attributionControl:!1,dragging:!this.options.centerFixed,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),scrollWheelZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),doubleClickZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:b.options.crs};return c=a.Util.extend(this.options.mapOptions,c),this._miniMap=new a.Map(this._container,c),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(a.Util.bind(function(){this._aimingRect=a.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=a.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(b){a.Control.prototype.addTo.call(this,b);var c=this.options.centerFixed||this._mainMap.getCenter();return this._miniMap.setView(c,this._decideZoom(!0)),this._setDisplay(this.options.minimized),this},onRemove:function(a){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(a){this._miniMap.removeLayer(this._layer),this._layer=a,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this.options.strings.hideText,"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_createButton:function(b,c,d,e,f,g){var h=a.DomUtil.create("a",d,e);h.innerHTML=b,h.href="#",h.title=c;var i=a.DomEvent.stopPropagation;return a.DomEvent.on(h,"click",i).on(h,"mousedown",i).on(h,"dblclick",i).on(h,"click",a.DomEvent.preventDefault).on(h,"click",f,g),h},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?(this._restore(),this._toggleDisplayButton.title=this.options.strings.hideText):(this._minimize(),this._toggleDisplayButton.title=this.options.strings.showText)},_setDisplay:function(a){a!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position):this._container.style.display="none",this._minimized=!0},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,"")):this._container.style.display="block",this._minimized=!1},_onMainMapMoved:function(a){if(this._miniMapMoving)this._miniMapMoving=!1;else{var b=this.options.centerFixed||this._mainMap.getCenter();this._mainMapMoving=!0,this._miniMap.setView(b,this._decideZoom(!0)),this._setDisplay(this._decideMinimized())}this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(a){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(a){if(!this.options.centerFixed){var b=this._aimingRect.getBounds(),c=this._miniMap.latLngToContainerPoint(b.getSouthWest()),d=this._miniMap.latLngToContainerPoint(b.getNorthEast());this._lastAimingRectPosition={sw:c,ne:d}}},_onMiniMapMoving:function(b){this.options.centerFixed||!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new a.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(a){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var a=this.options.zoomLevelFixed;return this._isDefined(a)&&this._isInteger(a)},_decideZoom:function(a){if(this._isZoomLevelFixed())return a?this.options.zoomLevelFixed:this._mainMap.getZoom();if(a)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var d,b=this._miniMap.getZoom()-this._mainMap.getZoom(),c=this._miniMap.getZoom()-this.options.zoomLevelOffset;return b>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(d=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):d=this._mainMap.getZoom():d=c,this._lastMiniMapZoom=this._miniMap.getZoom(),d},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?this._mainMap.getBounds().contains(this._miniMap.getBounds())?!0:!1:this._minimized},_isInteger:function(a){return"number"==typeof a},_isDefined:function(a){return"undefined"!=typeof a}});return a.Map.mergeOptions({miniMapControl:!1}),a.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new b).addTo(this))}),b},window);
/*
* Fullscreen plugin by https://github.com/mapbox/Leaflet.fullscreen
* License: https://github.com/mapbox/Leaflet.fullscreen/blob/master/LICENSE
*/
L.Control.Fullscreen=L.Control.extend({options:{position:mapsmarkerjspro.fullscreen_button_position,title:{"false":mapsmarkerjspro.fullscreen_button_title,"true":mapsmarkerjspro.fullscreen_button_title_exit}},onAdd:function(a){var b=L.DomUtil.create("div","leaflet-control-fullscreen leaflet-bar leaflet-control");return this.link=L.DomUtil.create("a","leaflet-control-fullscreen-button leaflet-bar-part",b),this.link.href="#",this._map=a,this._map.on("fullscreenchange",this._toggleTitle,this),this._toggleTitle(),L.DomEvent.on(this.link,"click",this._click,this),b},_click:function(a){L.DomEvent.stopPropagation(a),L.DomEvent.preventDefault(a),this._map.toggleFullscreen()},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}}),L.Map.include({isFullscreen:function(){return this._isFullscreen||!1},toggleFullscreen:function(){var a=this.getContainer();this.isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():(L.DomUtil.removeClass(a,"leaflet-pseudo-fullscreen"),this._setFullscreen(!1),this.invalidateSize(),this.fire("fullscreenchange")):a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):a.msRequestFullscreen?a.msRequestFullscreen():(L.DomUtil.addClass(a,"leaflet-pseudo-fullscreen"),this._setFullscreen(!0),this.invalidateSize(),this.fire("fullscreenchange"))},_setFullscreen:function(a){this._isFullscreen=a;var b=this.getContainer();a?L.DomUtil.addClass(b,"leaflet-fullscreen-on"):L.DomUtil.removeClass(b,"leaflet-fullscreen-on")},_onFullscreenChange:function(){var b=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;b!==this.getContainer()||this._isFullscreen?b!==this.getContainer()&&this._isFullscreen&&(this._setFullscreen(!1),this.fire("fullscreenchange")):(this._setFullscreen(!0),this.fire("fullscreenchange"))}}),L.Map.mergeOptions({fullscreenControl:!1}),L.Map.addInitHook(function(){this.options.fullscreenControl&&(this.fullscreenControl=new L.Control.Fullscreen,this.addControl(this.fullscreenControl));var a;if("onfullscreenchange"in document?a="fullscreenchange":"onmozfullscreenchange"in document?a="mozfullscreenchange":"onwebkitfullscreenchange"in document?a="webkitfullscreenchange":"onmsfullscreenchange"in document&&(a="MSFullscreenChange"),a){var b=L.bind(this._onFullscreenChange,this);this.whenReady(function(){L.DomEvent.on(document,a,b)}),this.on("unload",function(){L.DomEvent.off(document,a,b)})}}),L.control.fullscreen=function(a){return new L.Control.Fullscreen(a)};
/*
* GPX plugin, Copyright (C) 2011-2012 Pavel Shramov, Copyright (C) 2013 Maxime Petazzoni <maxime.petazzoni@bulix.org>
* License: https://github.com/mpetazzoni/leaflet-gpx/blob/master/LICENSE
*/
var _SECOND_IN_MILLIS=1e3,_MINUTE_IN_MILLIS=60*_SECOND_IN_MILLIS,_HOUR_IN_MILLIS=60*_MINUTE_IN_MILLIS;L.GPX=L.FeatureGroup.extend({initialize:function(a,b){L.Util.setOptions(this,b),"show"==mapsmarkerjspro.gpx_icons_status&&(L.GPXTrackIcon=L.Icon.extend({options:b.marker_options})),this._gpx=a,this._layers={},this._info={name:null,length:0,elevation:{gain:0,loss:0,_points:[]},hr:{avg:0,_total:0,_points:[]},duration:{start:null,end:null,moving:0,total:0}},a&&this._prepare_parsing(a,b,this.options.async)},get_duration_string:function(a,b){var c="";a>=_HOUR_IN_MILLIS&&(c+=Math.floor(a/_HOUR_IN_MILLIS)+":",a%=_HOUR_IN_MILLIS);var d=Math.floor(a/_MINUTE_IN_MILLIS);a%=_MINUTE_IN_MILLIS,10>d&&(c+="0"),c+=d+"'";var e=Math.floor(a/_SECOND_IN_MILLIS);return a%=_SECOND_IN_MILLIS,10>e&&(c+="0"),c+=e,c+=!b&&a>0?"."+Math.round(1e3*Math.floor(a))/1e3:'"'},to_miles:function(a){return a/1.60934},to_ft:function(a){return 3.28084*a},m_to_km:function(a){return a/1e3},m_to_mi:function(a){return a/1609.34},get_name:function(){return this._info.name},get_distance:function(){return this._info.length},get_distance_imp:function(){return this.to_miles(this.m_to_km(this.get_distance()))},get_start_time:function(){return this._info.duration.start},get_end_time:function(){return this._info.duration.end},get_moving_time:function(){return this._info.duration.moving},get_total_time:function(){return this._info.duration.total},get_moving_pace:function(){return this.get_moving_time()/this.m_to_km(this.get_distance())},get_moving_pace_imp:function(){return this.get_moving_time()/this.get_distance_imp()},get_elevation_gain:function(){return this._info.elevation.gain},get_elevation_loss:function(){return this._info.elevation.loss},get_elevation_data:function(){var a=this;return this._info.elevation._points.map(function(b){return a._prepare_data_point(b,a.m_to_km,null,function(a,b){return a.toFixed(2)+" km, "+b.toFixed(0)+" m"})})},get_elevation_data_imp:function(){var a=this;return this._info.elevation._points.map(function(b){return a._prepare_data_point(b,a.m_to_mi,a.to_ft,function(a,b){return a.toFixed(2)+" mi, "+b.toFixed(0)+" ft"})})},get_average_hr:function(){return this._info.hr.avg},get_heartrate_data:function(){var a=this;return this._info.hr._points.map(function(b){return a._prepare_data_point(b,a.m_to_km,null,function(a,b){return a.toFixed(2)+" km, "+b.toFixed(0)+" bpm"})})},get_heartrate_data_imp:function(){var a=this;return this._info.hr._points.map(function(b){return a._prepare_data_point(b,a.m_to_mi,null,function(a,b){return a.toFixed(2)+" mi, "+b.toFixed(0)+" bpm"})})},_htmlspecialchars_decode:function(a,b){var c=0,d=0,e=!1;"undefined"==typeof b&&(b=2),a=a.toString().replace(/&lt;/g,"<").replace(/&gt;/g,">");var f={ENT_NOQUOTES:0,ENT_HTML_QUOTE_SINGLE:1,ENT_HTML_QUOTE_DOUBLE:2,ENT_COMPAT:2,ENT_QUOTES:3,ENT_IGNORE:4};if(0===b&&(e=!0),"number"!=typeof b){for(b=[].concat(b),d=0;d<b.length;d++)0===f[b[d]]?e=!0:f[b[d]]&&(c|=f[b[d]]);b=c}return b&f.ENT_HTML_QUOTE_SINGLE&&(a=a.replace(/&#0*39;/g,"'")),e||(a=a.replace(/&quot;/g,'"')),a=a.replace(/&amp;/g,"&")},_merge_objs:function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},_prepare_data_point:function(a,b,c,d){var e=[b&&b(a[0])||a[0],c&&c(a[1])||a[1]];return e.push(d&&d(e[0],e[1])||e[0]+": "+e[1]),e},_prepare_parsing:function(a,b,c){var d=this,e=function(a,b){var c=d._parse_gpx_data(a,b);c&&(d.addLayer(c),setTimeout(function(){d.fire("gpx_loaded")},0))};void 0==c&&(c=this.options.async),void 0==b&&(b=this.options);var f=this._htmlspecialchars_decode(this.options.gpx_content),g=this._parse_xml(f);g?e(this._parse_xml(f),b):window.console&&console.log("error parsing xml")},_parse_xml:function(a){if("undefined"!=typeof window.DOMParser)return(new window.DOMParser).parseFromString(a,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var b=new window.ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b}throw new Error("No XML parser found")},_parse_gpx_data:function(a,b){var c,d,e,f=[],g=[["rte","rtept"],["trkseg","trkpt"]],h=a.getElementsByTagName("name");for(h.length>0&&(this._info.name=h[0].textContent||h[0].text||h[0].innerText),c=0;c<g.length;c++)for(e=a.getElementsByTagName(g[c][0]),d=0;d<e.length;d++){var i=this._parse_trkseg(e[d],a,b,g[c][1]);if(0!==i.length){var j=new L.Polyline(i,b.polyline_options);if(this.fire("addline",{line:j}),f.push(j),"show"==mapsmarkerjspro.gpx_icons_status){var k=new L.Marker(i[0],{clickable:!1,icon:new L.GPXTrackIcon({iconUrl:b.marker_options.startIconUrl})});this.fire("addpoint",{point:k}),f.push(k),k=new L.Marker(i[i.length-1],{clickable:!1,icon:new L.GPXTrackIcon({iconUrl:b.marker_options.endIconUrl})}),this.fire("addpoint",{point:k}),f.push(k)}}}if(this._info.hr.avg=Math.round(this._info.hr._total/this._info.hr._points.length),f.length){var l=f[0];return f.length>1&&(l=new L.FeatureGroup(f)),l}},_parseDate_for_IE8:function(a){var b=/^(\d{4})(?:-?W(\d+)(?:-?(\d+)D?)?|(?:-(\d+))?-(\d+))(?:[T ](\d+):(\d+)(?::(\d+)(?:\.(\d+))?)?)?(?:Z(-?\d*))?$/,c=a.match(b);if(null==c)throw new Error("Invalid Date");var d=Number(c[1]);if("undefined"!=typeof c[2]){var e=Number(c[2])-1,f=Number(c[3]);"undefined"==typeof f&&(f=0),f+=7*e;var g=0}else{if("undefined"!=typeof c[4])var g=Number(c[4])-1;else var g=0;var f=Number(c[5])}if("undefined"!=typeof c[6]&&"undefined"!=typeof c[7]){var h=Number(c[6]),i=Number(c[7]);if("undefined"!=typeof c[8]){var j=Number(c[8]);if("undefined"!=typeof c[9])var k=Number(c[9]),l=k/100;else var l=0}else var j=0,l=0}else var h=0,i=0,j=0,k=0,l=0;if("undefined"!=typeof c[10]){var m=-(new Date).getTimezoneOffset(),n=60*c[10];i=Number(i)+(n-m)}return new Date(d,g,f,h,i,j,l)},_parse_trkseg:function(a,b,c,d){var e=a.getElementsByTagName(d);if(!e.length)return[];for(var f=[],g=null,h=0;h<e.length;h++){var i,j=new L.LatLng(e[h].getAttribute("lat"),e[h].getAttribute("lon"));if(j.meta={time:null,ele:null,hr:null},i=e[h].getElementsByTagName("time"),i.length>0)if(window.addEventListener){var k=Date.parse(i[0].textContent);j.meta.time=new Date(k)}else j.meta.time=this._parseDate_for_IE8(i[0].text);if(i=e[h].getElementsByTagName("ele"),i.length>0&&(j.meta.ele=parseFloat(i[0].textContent||i[0].text||i[0].innerText)),i=e[h].getElementsByTagName("hr"),i.length>0&&(j.meta.hr=parseInt(i[0].textContent||i[0].text||i[0].innerText),this._info.hr._points.push([this._info.length,j.meta.hr]),this._info.hr._total+=j.meta.hr),this._info.elevation._points.push([this._info.length,j.meta.ele]),this._info.duration.end=j.meta.time,null!=g){this._info.length+=this._dist3d(g,j);var l=j.meta.ele-g.meta.ele;l>0?this._info.elevation.gain+=l:this._info.elevation.loss+=Math.abs(l),l=Math.abs(j.meta.time-g.meta.time),this._info.duration.total+=l,l<c.max_point_interval&&(this._info.duration.moving+=l)}else this._info.duration.start=j.meta.time;g=j,f.push(j)}return f},_dist2d:function(a,b){var c=6371e3,d=this._deg2rad(b.lat-a.lat),e=this._deg2rad(b.lng-a.lng),f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(this._deg2rad(a.lat))*Math.cos(this._deg2rad(b.lat))*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h},_dist3d:function(a,b){var c=this._dist2d(a,b),d=Math.abs(b.meta.ele-a.meta.ele);return Math.sqrt(Math.pow(c,2)+Math.pow(d,2))},_deg2rad:function(a){return a*Math.PI/180}});
/*
Copyright (c) 2016 Dominik Moritz, v0.49/14032016
This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],a):"object"==typeof exports&&("undefined"!=typeof b&&b.L?module.exports=a(L):module.exports=a(require("leaflet"))),"undefined"!=typeof b&&b.L&&(b.L.Locate=a(L))}(function(a){return a.Control.Locate=a.Control.extend({options:{position:"topleft",layer:void 0,drawCircle:!0,follow:!1,stopFollowingOnDrag:!1,remainActive:!1,markerClass:a.circleMarker,circleStyle:{color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:2,opacity:.5},markerStyle:{color:"#136AEC",fillColor:"#2A93EE",fillOpacity:.7,weight:2,opacity:.9,radius:5},followCircleStyle:{},followMarkerStyle:{},icon:"icon-location",iconLoading:"icon-spinner animate-spin",iconElementTag:"span",circlePadding:[0,0],metric:!0,onLocationError:function(a){alert(a.message)},onLocationOutsideMapBounds:function(a){a.stop(),alert(a.options.strings.outsideMapBoundsMsg)},setView:!0,keepCurrentZoomLevel:!1,showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0}},initialize:function(b){a.Map.addInitHook(function(){this.options.locateControl&&this.addControl(this)});for(var c in b)"object"==typeof this.options[c]?a.extend(this.options[c],b[c]):this.options[c]=b[c];a.extend(this.options.locateOptions,{setView:!1})},_activate:function(){this.options.setView&&(this._locateOnNextLocationFound=!0),this._active||this._map.locate(this.options.locateOptions),this._active=!0,this.options.follow&&this._startFollowing(this._map)},_deactivate:function(){this._map.stopLocate(),this._map.off("dragstart",this._stopFollowing,this),this.options.follow&&this._following&&this._stopFollowing(this._map)},drawMarker:function(b){void 0===this._event.accuracy&&(this._event.accuracy=0);var c=this._event.accuracy;this._locateOnNextLocationFound&&(this._isOutsideMapBounds()?this.options.onLocationOutsideMapBounds(this):this.options.keepCurrentZoomLevel?b.panTo([this._event.latitude,this._event.longitude]):b.fitBounds(this._event.bounds,{padding:this.options.circlePadding,maxZoom:this.options.keepCurrentZoomLevel?b.getZoom():this.options.locateOptions.maxZoom}),this._locateOnNextLocationFound=!1);var d,e;if(this.options.drawCircle)if(d=this._following?this.options.followCircleStyle:this.options.circleStyle,this._circle){this._circle.setLatLng(this._event.latlng).setRadius(c);for(e in d)this._circle.options[e]=d[e]}else this._circle=a.circle(this._event.latlng,c,d).addTo(this._layer);var f,g;this.options.metric?(f=c.toFixed(0),g=this.options.strings.metersUnit):(f=(3.2808399*c).toFixed(0),g=this.options.strings.feetUnit);var h;h=this._following?this.options.followMarkerStyle:this.options.markerStyle,this._marker?this.updateMarker(this._event.latlng,h):this._marker=this.createMarker(this._event.latlng,h).addTo(this._layer);var i=this.options.strings.popup;this.options.showPopup&&i&&this._marker.bindPopup(a.Util.template(i,{distance:f,unit:g}))._popup.setLatLng(this._event.latlng),this._toggleContainerStyle()},createMarker:function(a,b){return this.options.markerClass(a,b)},updateMarker:function(a,b){this._marker.setLatLng(a);for(var c in b)this._marker.options[c]=b[c]},removeMarker:function(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},onAdd:function(b){var c=a.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._layer=this.options.layer||new a.LayerGroup,this._layer.addTo(b),this._event=void 0;var d={};return a.extend(d,this.options.markerStyle,this.options.followMarkerStyle),this.options.followMarkerStyle=d,d={},a.extend(d,this.options.circleStyle,this.options.followCircleStyle),this.options.followCircleStyle=d,this._link=a.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single "+this.options.icon,c),this._link.href="#",this._link.title=this.options.strings.title,this._icon=a.DomUtil.create(this.options.iconElementTag,this.options.icon,this._link),a.DomEvent.on(this._link,"click",a.DomEvent.stopPropagation).on(this._link,"click",a.DomEvent.preventDefault).on(this._link,"click",function(){var a=void 0===this._event||this._map.getBounds().contains(this._event.latlng)||!this.options.setView||this._isOutsideMapBounds();!this.options.remainActive&&this._active&&a?this.stop():this.start()},this).on(this._link,"dblclick",a.DomEvent.stopPropagation),this._resetVariables(),this.bindEvents(b),c},bindEvents:function(a){a.on("locationfound",this._onLocationFound,this),a.on("locationerror",this._onLocationError,this),a.on("unload",this.stop,this)},start:function(){this._activate(),this._event?this.drawMarker(this._map):this._setClasses("requesting")},stop:function(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this.removeMarker()},_onLocationError:function(a){3==a.code&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(a))},_onLocationFound:function(a){this._event&&this._event.latlng.lat===a.latlng.lat&&this._event.latlng.lng===a.latlng.lng&&this._event.accuracy===a.accuracy||this._active&&(this._event=a,this.options.follow&&this._following&&(this._locateOnNextLocationFound=!0),this.drawMarker(this._map))},_startFollowing:function(){this._map.fire("startfollowing",this),this._following=!0,this.options.stopFollowingOnDrag&&this._map.on("dragstart",this._stopFollowing,this)},_stopFollowing:function(){this._map.fire("stopfollowing",this),this._following=!1,this.options.stopFollowingOnDrag&&this._map.off("dragstart",this._stopFollowing,this),this._toggleContainerStyle()},_isOutsideMapBounds:function(){return void 0===this._event?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_toggleContainerStyle:function(){this._container&&(this._following?this._setClasses("following"):this._setClasses("active"))},_setClasses:function(b){"requesting"==b?(a.DomUtil.removeClasses(this._container,"active following"),a.DomUtil.addClasses(this._container,"requesting"),a.DomUtil.removeClasses(this._icon,this.options.icon),a.DomUtil.addClasses(this._icon,this.options.iconLoading)):"active"==b?(a.DomUtil.removeClasses(this._container,"requesting following"),a.DomUtil.addClasses(this._container,"active"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon)):"following"==b&&(a.DomUtil.removeClasses(this._container,"requesting"),a.DomUtil.addClasses(this._container,"active following"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon))},_cleanClasses:function(){a.DomUtil.removeClass(this._container,"requesting"),a.DomUtil.removeClass(this._container,"active"),a.DomUtil.removeClass(this._container,"following"),a.DomUtil.removeClasses(this._icon,this.options.iconLoading),a.DomUtil.addClasses(this._icon,this.options.icon)},_resetVariables:function(){this._active=!1,this._locateOnNextLocationFound=this.options.setView,this._following=!1}}),a.control.locate=function(b){return new a.Control.Locate(b)},function(){var b=function(b,c,d){d=d.split(" "),d.forEach(function(d){a.DomUtil[b].call(this,c,d)})};a.DomUtil.addClasses=function(a,c){b("addClass",a,c)},a.DomUtil.removeClasses=function(a,c){b("removeClass",a,c)}}(),a.Control.Locate},window);
/*
URL hashes - based on leaflet-hash.js, Copyright (c) 2013 @mlevans, MIT License
https://github.com/mlevans/leaflet-hash
*/
!function(a){var b=function(){var b=a.documentMode;return"onhashchange"in a&&(void 0===b||b>7)}();L.Hash=function(b){"undefined"==typeof a.leaflet_hash_requested&&(this.onHashChange=L.Util.bind(this.onHashChange,this),b&&this.init(b),this.events=new Object,a.leaflet_hash_requested=!0)},L.Hash.parseHash=function(a){0===a.indexOf("#")&&(a=a.substr(1));var b=a.split("/");if(3==b.length){var c=parseInt(b[0],10),d=parseFloat(b[1]),e=parseFloat(b[2]);return isNaN(c)||isNaN(d)||isNaN(e)?!1:{center:new L.LatLng(d,e),zoom:c}}return!1},L.Hash.formatHash=function(a){var b=a.getCenter(),c=a.getZoom(),d=Math.max(0,Math.ceil(Math.log(c)/Math.LN2));return"#"+[c,b.lat.toFixed(d),b.lng.toFixed(d)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(a){this.map=a,this.lastHash=null,this.onHashChange(),this.startListening()},removeFrom:function(a){this.changeTimeout&&clearTimeout(this.changeTimeout),this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var a=location.hash.split("/"),b=location.hash.charAt(1);if(3!=a.length&&!isNaN(parseFloat(b))&&isFinite(b))return!1;var c=this.formatHash(this.map);if(this.events.change)for(var d=0;d<this.events.change.length;d++)c=this.events.change[d](c);if(this.lastHash!=c&&(location.replace(c),this.lastHash=c,this.events.hash))for(var d=0;d<this.events.hash.length;d++)this.events.hash[d](c)},movingMap:!1,update:function(){var a=location.hash;if(a!==this.lastHash){var b=this.parseHash(a);if(b){if(this.movingMap=!0,this.map.setView(b.center,b.zoom,{animate:!1}),this.events.update)for(var c=0;c<this.events.update.length;c++)this.events.update[c](a);this.movingMap=!1}else this.onMapMove(this.map)}},on:function(a,b){this.events[a]?this.events[a].push(b):this.events[a]=[b]},off:function(a,b){if(this.events[a])for(var c=0;c<this.events[a].length;c++)if(this.events[a][c]==b)return void this.events[a].splice(c)},trigger:function(a){"move"==a&&(this.movingMap||this.onMapMove())},setMovingMap:function(){this.movingMap=!0},clearMovingMap:function(){this.movingMap=!1},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var a=this;this.changeTimeout=setTimeout(function(){a.update(),a.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.isListening||(this.map.on("moveend",this.onMapMove,this),b?L.DomEvent.addListener(a,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0)},stopListening:function(){this.isListening&&(this.map.off("moveend",this.onMapMove,this),b?L.DomEvent.removeListener(a,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1)}},L.hash=function(a){return new L.Hash(a)},L.Map.include({addHash:function(){return this._hash=L.hash(this),this},removeHash:function(){return this._hash.remove(),this}})}(window);
/*
 * Leaflet.MarkerCluster.LayerSupport sub-plugin for Leaflet.markercluster plugin, MIT license (expat type)
 * Copyright (c) 2015 Boris Seang
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],function(c){return a.L.MarkerClusterGroup.LayerSupport=b(c)}):"object"==typeof module&&module.exports?module.exports=b(require("leaflet")):a.L.MarkerClusterGroup.LayerSupport=b(a.L)}(this,function(a,b){var c=a.MarkerClusterGroup,d=c.prototype,e=a.FeatureGroup.EVENTS,f=c.extend({statics:{version:"0.1.0"},options:{singleAddRemoveBufferDuration:100},initialize:function(a){d.initialize.call(this,a),this._featureGroup=new g,this._featureGroup.on(e,this._propagateEvent,this),this._nonPointGroup=new g,this._nonPointGroup.on(e,this._propagateEvent,this),this._layers={},this._proxyLayerGroups={},this._proxyLayerGroupsNeedRemoving={},this._singleAddRemoveBuffer=[]},checkIn:function(a){var b=this._toArray(a);return this._checkInGetSeparated(b),this},checkOut:function(b){var g,h,c=this._toArray(b),d=this._separateSingleFromGroupLayers(c,{groups:[],singles:[]}),e=d.groups,f=d.singles;for(g=0;g<f.length;g++)h=f[g],delete this._layers[a.stamp(h)],delete h._mcgLayerSupportGroup;for(this._originalRemoveLayers(f),g=0;g<e.length;g++)h=e[g],this._dismissProxyLayerGroup(h);return this},addLayers:function(b){var f,g,h,c=this._toArray(b),d=this._checkInGetSeparated(c),e=d.groups;for(this._originalAddLayers(d.singles),f=0;f<e.length;f++)g=e[f],h=a.stamp(g),this._proxyLayerGroups[h]=g,delete this._proxyLayerGroupsNeedRemoving[h],this._map&&this._map._originalAddLayer(g)},addLayer:function(a){return this._bufferSingleAddRemove(a,"addLayers"),this},_originalAddLayer:d.addLayer,_originalAddLayers:d.addLayers,removeLayers:function(b){var h,i,c=this._toArray(b),d=this._separateSingleFromGroupLayers(c,{groups:[],singles:[]}),e=d.groups,f=d.singles,g=0;for(this._originalRemoveLayers(f);g<e.length;g++)h=e[g],i=a.stamp(h),delete this._proxyLayerGroups[i],this._map?this._map._originalRemoveLayer(h):this._proxyLayerGroupsNeedRemoving[i]=h;return this},removeLayer:function(a){return this._bufferSingleAddRemove(a,"removeLayers"),this},_originalRemoveLayer:d.removeLayer,_originalRemoveLayers:d.removeLayers,onAdd:function(b){b._originalAddLayer=b._originalAddLayer||b.addLayer,b._originalRemoveLayer=b._originalRemoveLayer||b.removeLayer,a.extend(b,i);var e,f,g,c=this._removePreAddedLayers(b);d.onAdd.call(this,b);for(e in this._proxyLayerGroups)f=this._proxyLayerGroups[e],b._originalAddLayer(f);for(e in this._proxyLayerGroupsNeedRemoving)f=this._proxyLayerGroupsNeedRemoving[e],b._originalRemoveLayer(f),delete this._proxyLayerGroupsNeedRemoving[e];for(g=0;g<c.length;g++)b.addLayer(c[g])},_bufferSingleAddRemove:function(b,c){var e,d=this.options.singleAddRemoveBufferDuration;d>0?(this._singleAddRemoveBuffer.push({type:c,layer:b}),this._singleAddRemoveBufferTimeout||(e=a.bind(this._processSingleAddRemoveBuffer,this),this._singleAddRemoveBufferTimeout=setTimeout(e,d))):this[c](b)},_processSingleAddRemoveBuffer:function(){for(var d,e,a=this._singleAddRemoveBuffer,b=0,c=[];b<a.length;b++)d=a[b],e||(e=d.type),d.type===e?c.push(d.layer):(this[e](c),c=[d.layer]);this[e](c),a.length=0,clearTimeout(this._singleAddRemoveBufferTimeout),this._singleAddRemoveBufferTimeout=null},_checkInGetSeparated:function(b){var f,g,c=this._separateSingleFromGroupLayers(b,{groups:[],singles:[]}),d=c.groups,e=c.singles;for(f=0;f<d.length;f++)g=d[f],this._recruitLayerGroupAsProxy(g);for(f=0;f<e.length;f++)g=e[f],this._removeFromOtherGroupsOrMap(g),this._layers[a.stamp(g)]=g,g._mcgLayerSupportGroup=this;return c},_separateSingleFromGroupLayers:function(b,c){for(var g,d=c.groups,e=c.singles,f=a.Util.isArray,h=0;h<b.length;h++)g=b[h],g instanceof a.LayerGroup?(d.push(g),this._separateSingleFromGroupLayers(g.getLayers(),c)):f(g)?this._separateSingleFromGroupLayers(g,c):e.push(g);return c},_recruitLayerGroupAsProxy:function(b){var c=b._proxyMcgLayerSupportGroup;if(c){if(c===this)return;c.checkOut(b)}else this._removeFromOwnMap(b);b._proxyMcgLayerSupportGroup=this,b._originalAddLayer=b._originalAddLayer||b.addLayer,b._originalRemoveLayer=b._originalRemoveLayer||b.removeLayer,a.extend(b,h)},_dismissProxyLayerGroup:function(c){if(c._proxyMcgLayerSupportGroup!==b&&c._proxyMcgLayerSupportGroup===this){delete c._proxyMcgLayerSupportGroup,c.addLayer=c._originalAddLayer,c.removeLayer=c._originalRemoveLayer;var d=a.stamp(c);delete this._proxyLayerGroups[d],delete this._proxyLayerGroupsNeedRemoving[d],this._removeFromOwnMap(c)}},_removeFromOtherGroupsOrMap:function(a){var b=a._mcgLayerSupportGroup;if(b){if(b===this)return;b.checkOut(a)}else a.__parent?a.__parent._group.removeLayer(a):this._removeFromOwnMap(a)},_removeFromOwnMap:function(a){a._map&&a._map.removeLayer(a)},_removePreAddedLayers:function(a){var d,b=this._layers,c=[];for(var e in b)d=b[e],d._map&&(c.push(d),a._originalRemoveLayer(d));return c},_toArray:function(b){return a.Util.isArray(b)?b:[b]}}),g=a.FeatureGroup.extend({addLayer:function(b){if(this.hasLayer(b))return this;"on"in b&&b.on(e,this._propagateEvent,this);var c=a.stamp(b);return this._layers[c]=b,this._map&&this._map._originalAddLayer(b),this._popupContent&&b.bindPopup&&b.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:b})},removeLayer:function(b){if(!this.hasLayer(b))return this;b in this._layers&&(b=this._layers[b]),"off"in b&&b.off(e,this._propagateEvent,this);var c=a.stamp(b);return this._map&&this._layers[c]&&this._map._originalRemoveLayer(this._layers[c]),delete this._layers[c],this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:b})},onAdd:function(a){this._map=a,this.eachLayer(a._originalAddLayer,a)},onRemove:function(a){this.eachLayer(a._originalRemoveLayer,a),this._map=null}}),h={addLayer:function(a){var b=this.getLayerId(a);return this._layers[b]=a,this._map?this._proxyMcgLayerSupportGroup.addLayer(a):this._proxyMcgLayerSupportGroup.checkIn(a),this},removeLayer:function(a){var b=a in this._layers?a:this.getLayerId(a);return this._proxyMcgLayerSupportGroup.removeLayer(a),delete this._layers[b],this}},i={addLayer:function(a){return a._mcgLayerSupportGroup?a._mcgLayerSupportGroup._originalAddLayer(a):this._originalAddLayer(a)},removeLayer:function(a){return a._mcgLayerSupportGroup?a._mcgLayerSupportGroup._originalRemoveLayer(a):this._originalRemoveLayer(a)}};return a.markerClusterGroup.layerSupport=function(b){return new a.MarkerClusterGroup.LayerSupport(b)},f});
/*
Leaflet zoom control with a home button for resetting the view.
*/
!function(){"use strict";L.Control.ZoomHome=L.Control.extend({options:{position:"topleft",mapId:"",mapnameJS:"",ondemand:!1,zoomHomeTitle:"Home",homeCoordinates:null,homeZoom:null,reenableClustering:!1},onAdd:function(a){var b="leaflet-control-zoomhome",c=L.DomUtil.create("div",b+" leaflet-bar"),d=this.options;c.setAttribute("id","leaflet-control-zoomhome-"+d.mapId),1==d.ondemand&&(c.style.display="none"),null===d.homeCoordinates&&(d.homeCoordinates=a.getCenter()),null===d.homeZoom&&(d.homeZoom=a.getZoom());var e='<span class="lmm-icon-zoomhome"></span>';return this._zoomHomeButton=this._createButton(e,d.zoomHomeTitle,b+"-home lmm-icon-zoomhome",c,this._zoomHome.bind(this)),c},_zoomHome:function(a){var b=this.options.reenableClustering;this._map.closePopup(),this._map.setView(this.options.homeCoordinates,this.options.homeZoom,{reset:!0,animate:!1}),"true"===b&&window["markercluster_"+this.options.mapnameJS].enableClustering();var c=this.options.mapId,d=this.options.ondemand;setTimeout(function(){1==d&&(document.getElementById("leaflet-control-zoomhome-"+c).style.display="none")},500)},_createButton:function(a,b,c,d,e){var f=L.DomUtil.create("a",c,d);return f.innerHTML=a,f.href="#",f.title=b,L.DomEvent.on(f,"mousedown dblclick",L.DomEvent.stopPropagation).on(f,"click",L.DomEvent.stop).on(f,"click",e,this).on(f,"click",this._refocusOnMap,this),f}}),L.Control.zoomHome=function(a){return new L.Control.ZoomHome(a)}}();
/*
Javascript Events API for LeafletJS, https://mapsmarker.com/jseventsapi/
*/
var MMP={maps:{byId:function(a){return window[MMP.maps[a]]},onAll:function(a,b){jQuery.each(MMP.maps,function(c,d){isNaN(c)||window[d].on(a,b)})},toAll:function(a){jQuery.each(MMP.maps,function(b,c){isNaN(b)||a(window[c])})}}};
/*
Maps filters
*/
L.Control.Filters=L.Control.Layers.extend({options:{position:"topright",autoZIndex:!0,hideSingleBase:!1},_addItem:function(a){var d,b=document.createElement("label"),c=this._map.hasLayer(a.layer);a.overlay?(d=document.createElement("input"),d.type="checkbox",d.id=a.layer.layer_id,d.setAttribute("markercount",a.layer.markercount),d.className="leaflet-control-layers-selector lmm-filter",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers",c),d.layerId=L.stamp(a.layer),L.DomEvent.on(d,"click",this._onInputClick,this);var e=document.createElement("span");e.innerHTML=" "+a.name;var f=document.createElement("div");b.appendChild(f),f.appendChild(d),f.appendChild(e);var g=a.overlay?this._overlaysList:this._baseLayersList;return g.appendChild(b),b},_initLayout:function(){var a="leaflet-control-layers",b=this._container=L.DomUtil.create("div",a);b.setAttribute("aria-haspopup",!0),L.Browser.touch?L.DomEvent.on(b,"click",L.DomEvent.stopPropagation):L.DomEvent.disableClickPropagation(b).disableScrollPropagation(b);var c=this._form=L.DomUtil.create("form",a+"-list");if(this.options.collapsed){L.Browser.android||L.DomEvent.on(b,"mouseover",this._expand,this).on(b,"mouseout",this._collapse,this);var d=this._layersLink=L.DomUtil.create("a",a+"-toggle lmm-filters-icon",b);d.href="#",d.title="Layers",L.Browser.touch?L.DomEvent.on(d,"click",L.DomEvent.stop).on(d,"click",this._expand,this):L.DomEvent.on(d,"focus",this._expand,this),L.DomEvent.on(c,"click",function(){setTimeout(L.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",a+"-base",c),this._separator=L.DomUtil.create("div",a+"-separator",c),this._overlaysList=L.DomUtil.create("div",a+"-overlays",c),b.appendChild(c)}}),L.control.filters=function(a,b,c){return new L.Control.Filters(a,b,c)};
/*
dynamic markers list pagination
*/
function mmp_askForMarkersFromPagination(a,b,c){if(null==a||!jQuery(a).hasClass("current-page")){if(!b)var b=jQuery(a).html();if(!c)var c=jQuery(a).attr("data-mapid");var d=jQuery("#markers_per_page_"+c).val();if("undefined"!=typeof jQuery("#search_markers_"+c).val())var e=jQuery("#search_markers_"+c).val();else var e="";if("undefined"!=typeof jQuery("#id").val())var f=jQuery("#id").val();else var f=jQuery("#"+c+"_id").val();var g=jQuery("#lmm_listmarkers_table_"+c).attr("data-mapname"),h="",i="";if("undefined"!=typeof window["mmp_cache_current_location_"+c])var h=window["mmp_cache_current_location_"+c].latitude,i=window["mmp_cache_current_location_"+c].longitude;if(null!=a)var j=a;else var j="#pagination_"+c+" .first-page:first";jQuery.ajax({url:lmm_ajax_vars.lmm_ajax_url,data:{action:"mapsmarker_ajax_actions_frontend",lmm_ajax_subaction:"lmm_list_markers",lmm_ajax_nonce:lmm_ajax_vars.lmm_ajax_nonce,paged:b,order_by:jQuery("#"+c+"_orderby").val(),order:jQuery("#"+c+"_order").val(),multi_layer_map:jQuery("#"+c+"_multi_layer_map").val(),multi_layer_map_list:jQuery("#"+c+"_multi_layer_map_list").val(),markercount:jQuery("#"+c+"_markercount").val(),mapid:c,layerlat:h,layerlon:i,per_page:d,mapname:g,search_text:e,id:f},beforeSend:function(){c&&jQuery(".lmm-filter").attr("disabled","disabled"),""!=e&&jQuery(".lmm-search-markers").addClass("searchtext_loading"),jQuery("#pagination_"+c).html('<img src="'+lmm_ajax_vars.lmm_ajax_leaflet_plugin_url+'inc/img/paging-ajax-loader.gif"/>')},method:"POST",success:function(a){var b=a.replace(/^\s*[\r\n]/gm,""),b=b.match(/!!LMM-AJAX-START!!(.*[\s\S]*)!!LMM-AJAX-END!!/)[1],d=JSON.parse(b);if(jQuery("#lmm_listmarkers_table_"+c).html(d.rows),jQuery("#lmm_listmarkers_table_"+c).append('<tr id="pagination_row_'+c+'"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+c+'" class="tablenav-pages">'+d.pager+"</div></div></td></tr>"),jQuery(j).addClass("current-page"),""==e)try{window["mmp_calculate_total_markers_"+c]()}catch(f){}c&&jQuery(".lmm-filter").removeAttr("disabled")}})}}jQuery(document).on("click","a.first-page",function(a,b){a.preventDefault(),mmp_askForMarkersFromPagination(this)});
/*
dynamic markers per page
*/
jQuery(document).on("change",".lmm-per-page-input",function(a){var b=parseInt(jQuery(this).val()),c=jQuery(this).attr("data-mapid");if("undefined"!=typeof jQuery("#id").val())var d=jQuery("#id").val();else var d=jQuery("#"+c+"_id").val();var e=jQuery("#search_markers_"+c).val();if(!isNaN(b)){jQuery(".current-page").removeClass("current-page");var f=this;jQuery.ajax({url:lmm_ajax_vars.lmm_ajax_url,data:{action:"mapsmarker_ajax_actions_frontend",lmm_ajax_subaction:"lmm_list_markers",lmm_ajax_nonce:lmm_ajax_vars.lmm_ajax_nonce,paged:1,order_by:jQuery("#"+c+"_orderby").val(),order:jQuery("#"+c+"_order").val(),multi_layer_map:jQuery("#"+c+"_multi_layer_map").val(),multi_layer_map_list:jQuery("#"+c+"_multi_layer_map_list").val(),markercount:jQuery("#"+c+"_markercount").val(),mapid:c,per_page:b,search_text:e,id:d},beforeSend:function(){jQuery("#pagination_"+c).html('<img src="'+lmm_ajax_vars.lmm_ajax_leaflet_plugin_url+'inc/img/paging-ajax-loader.gif"/>')},method:"POST",success:function(a){var b=a.replace(/^\s*[\r\n]/gm,""),b=b.match(/!!LMM-AJAX-START!!(.*[\s\S]*)!!LMM-AJAX-END!!/)[1],d=JSON.parse(b);if("undefined"!=typeof d.pager?(jQuery("#lmm_listmarkers_table_"+c).html(d.rows),jQuery("#lmm_listmarkers_table_"+c).append('<tr id="pagination_row_'+c+'"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+c+'" class="tablenav-pages">'+d.pager+"</div></div></td></tr>")):jQuery("#pagination_"+c).html(""),jQuery(f).addClass("current-page"),""==e)try{window["mmp_calculate_total_markers_"+c]()}catch(g){}}})}});
/*
dynamic search
*/
function mmp_debounce(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}function mmp_askForMarkers(a){if(jQuery(a.target).val().length>0){var b=String.fromCharCode(a.which);if(/[a-zA-Z0-9-_ ]/.test(b)||13==a.which){var c=jQuery(a.target).attr("data-mapid");mmp_get_markers(a.target,c)}}else if(0==jQuery(a.target).val().length&&(17==a.which||8==a.which)){var c=jQuery(a.target).attr("data-mapid");mmp_get_markers(a.target,c)}}function mmp_askForMarkersFromDropdown(a){var b=jQuery(a.target).parent().attr("data-mapid"),c=jQuery(a.target).attr("data-sortby"),d=jQuery("#lmm_listmarkers_table_"+b).attr("data-mapname");"distance_current_position"==c?"undefined"!=typeof window["mmp_cache_current_location_"+b]?mmp_get_markers(a.target,b,window["mmp_cache_current_location_"+b]):"undefined"!=typeof window["locatecontrol_"+d]?(window["locatecontrol_"+d].start(),window[d].on("locationfound",function(c){"undefined"==typeof window["mmp_cache_current_location_"+b]&&(window["mmp_cache_current_location_"+b]=c,mmp_get_markers(a.target,b,c))})):window[d].locate().on("locationfound",function(c){"undefined"==typeof window["mmp_cache_current_location_"+b]&&(window["mmp_cache_current_location_"+b]=c,mmp_get_markers(a.target,b,c))}):mmp_get_markers(a.target,b)}function mmp_get_markers(a,b,c){var d=jQuery("#search_markers_"+b).val(),e=jQuery(a).attr("data-sortby"),f=jQuery("#lmm_listmarkers_table_"+b).attr("data-mapname");if("undefined"!=typeof jQuery("#id").val())var g=jQuery("#id").val();else var g=jQuery("#"+b+"_id").val();if(c)var h=c.latitude,i=c.longitude;if(jQuery(a).hasClass("lmm-sort-by")&&jQuery(a).hasClass("up")){var j="desc";jQuery(".lmm-sort-by").removeClass("up"),jQuery(".lmm-sort-by").removeClass("down"),jQuery(a).removeClass("up"),jQuery(a).addClass("down")}else{var j="asc";jQuery(".lmm-sort-by").removeClass("up"),jQuery(".lmm-sort-by").removeClass("down"),jQuery(a).removeClass("down"),jQuery(a).addClass("up")}var k=parseInt(jQuery("#markers_per_page_"+b).val());jQuery(".current-page").removeClass("current-page");var l=a;jQuery.ajax({url:lmm_ajax_vars.lmm_ajax_url,data:{action:"mapsmarker_ajax_actions_frontend",lmm_ajax_subaction:"lmm_list_markers",lmm_ajax_nonce:lmm_ajax_vars.lmm_ajax_nonce,paged:1,multi_layer_map:jQuery("#"+b+"_multi_layer_map").val(),multi_layer_map_list:jQuery("#"+b+"_multi_layer_map_list").val(),markercount:jQuery("#"+b+"_markercount").val(),mapid:b,per_page:k,search_text:d,order_by:e,order:j,layerlat:h,layerlon:i,mapname:f,id:g},beforeSend:function(){jQuery("#pagination_"+b).html('<img src="'+lmm_ajax_vars.lmm_ajax_leaflet_plugin_url+'inc/img/paging-ajax-loader.gif"/>'),""!=d&&jQuery("#search_markers_"+b).addClass("searchtext_loading")},method:"POST",success:function(a){var c=a.replace(/^\s*[\r\n]/gm,""),c=c.match(/!!LMM-AJAX-START!!(.*[\s\S]*)!!LMM-AJAX-END!!/)[1],e=JSON.parse(c);if(jQuery("#lmm_listmarkers_table_"+b).html(e.rows),1==e.no_pagination?""!=d&&0==e.mcount?jQuery("#lmm_listmarkers_table_"+b).append('<tr id="pagination_row_'+b+'"><td colspan="2" style="text-align:center"><div class="tablenav">'+lmm_ajax_vars.lmm_ajax_text_no_results_found+"</div></td></tr>"):jQuery("#lmm_listmarkers_table_"+b).append('<tr id="pagination_row_'+b+'" style="display:none;"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+b+'" class="tablenav-pages">'+e.pager+"</div></div></td></tr>"):jQuery("#lmm_listmarkers_table_"+b).append('<tr id="pagination_row_'+b+'"><td colspan="2" style="text-align:center"><div class="tablenav"><div id="pagination_'+b+'" class="tablenav-pages">'+e.pager+"</div></div></td></tr>"),jQuery(l).addClass("current-page"),""!=d){jQuery("#search_markers_"+b).focus();var f=jQuery("#search_markers_"+b).val();jQuery("#search_markers_"+b).val(""),jQuery("#search_markers_"+b).val(f)}else try{window["mmp_calculate_total_markers_"+b]()}catch(g){}}})}jQuery(document).on("keyup",".lmm-search-markers",mmp_debounce(mmp_askForMarkers,500)),jQuery(document).on("click",".lmm-sort-by",mmp_debounce(mmp_askForMarkersFromDropdown,500));
/**
* Leaflet.MarkerCluster.Freezable sub-plugin for Leaflet.markercluster plugin. Copyright (c) 2015 Boris Seang, MIT License (Expat type)
*/
!function(a,b){"function"==typeof define&&define.amd?define(["leaflet"],function(c){return a.L.MarkerClusterGroup=b(c)}):"object"==typeof module&&module.exports?module.exports=b(require("leaflet")):a.L.MarkerClusterGroup=b(a.L)}(this,function(a,b){var c=a.MarkerClusterGroup,d=c.prototype;return c.freezableVersion="0.1.0",c.include({_originalOnAdd:d.onAdd,onAdd:function(a){var b=this._zoom;this._originalOnAdd(a),this._frozen&&(b>=0&&b!==this._zoom&&(this._featureGroup.clearLayers(),this._zoom=b,this.addLayers([])),a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),a.on("zoomend moveend",this._viewChangeEndNotClustering,this))},_originalOnRemove:d.onRemove,onRemove:function(a){a.off("zoomend moveend",this._viewChangeEndNotClustering,this),this._originalOnRemove(a)},disableClustering:function(){return this.freezeAtZoom(this._maxZoom+1)},disableClusteringKeepSpiderfy:function(){return this.freezeAtZoom(this._maxZoom)},enableClustering:function(){return this.unfreeze()},unfreeze:function(){return this.freezeAtZoom(!1)},freezeAtZoom:function(a){this._processQueue();var c=this._map;a===b||a===!0||a!==a?a=c?Math.round(c.getZoom()):-1:"max"===a?a=this._maxZoom+1:"maxKeepSpiderfy"===a&&(a=this._maxZoom);var d="number"==typeof a;if(this._frozen){if(!d)return this._unfreeze(),this}else{if(!d)return this;this._initiateFreeze()}return this._artificialZoomSafe(this._zoom,a),this},_initiateFreeze:function(){var a=this._map;this._frozen=!0,a&&(a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),a.on("zoomend moveend",this._viewChangeEndNotClustering,this))},_unfreeze:function(){var a=this._map;this._frozen=!1,a&&(a.off("zoomend moveend",this._viewChangeEndNotClustering,this),a.on("zoomend",this._zoomEnd,this),a.on("moveend",this._moveEnd,this),this._executeAfterUnspiderfy(function(){this._zoomEnd()},this))},_executeAfterUnspiderfy:function(a,b){return this._unspiderfy&&this._spiderfied?(this.once("animationend",function(){a.call(b)}),void this._unspiderfy()):void a.call(b)},_artificialZoomSafe:function(a,b){this._zoom=b,this._map&&a!==b&&this._executeAfterUnspiderfy(function(){this._artificialZoom(a,b)},this)},_artificialZoom:function(a,b){b>a?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,a,this._getExpandedVisibleBounds()),this._animationZoomIn(a,b)):a>b&&(this._animationStart(),this._animationZoomOut(a,b))},_viewChangeEndNotClustering:function(){var a=this._featureGroup,b=this._getExpandedVisibleBounds(),c=this._zoom;a.eachLayer(function(d){!b.contains(d._latlng)&&d.__parent&&d.__parent._zoom<c&&a.removeLayer(d)}),this._topClusterLevel._recursively(b,-1,c,function(d){if(d._zoom!==c)for(var g,e=d._markers,f=0;f<e.length;f++)g=d._markers[f],b.contains(g._latlng)&&a.addLayer(g)},function(a){a._addToMap()})},_originalZoomOrSpiderfy:d._zoomOrSpiderfy,_zoomOrSpiderfy:function(a){this._frozen&&this.options.spiderfyOnMaxZoom?(a.layer.spiderfy(),a.originalEvent&&13===a.originalEvent.keyCode&&map._container.focus()):this._originalZoomOrSpiderfy(a)}}),c});